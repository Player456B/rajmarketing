<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Customer Dashboard | Raj Marketing Mysore</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css?family=Poppins:400,600,700&display=swap" rel="stylesheet"/>
  <link rel="icon" href="../images/logo.svg">
  <style>
    :root { --primary: #0e2a47; --secondary: #3bb4f2; --dark-yellow: #ffd600; --gold: #ffd700; --silver: #d0d0d0; --bronze: #b08d57; --white: #fff;}
    body { background: var(--primary); color: var(--white); font-family: 'Poppins', sans-serif; margin: 0;}
    .cover { height: 140px; width: 100%; border-radius: 0 0 32px 32px; position: relative;}
    .profile-box { display: flex; flex-direction: column; align-items: center; margin-top:-65px; z-index:2; position:relative;}
    .profile-pic { width: 110px; height: 110px; border-radius: 50%; border: 4px solid #fff; background: #18345a; object-fit:cover;}
    .upload-btn { position: absolute; right:11px; top:101px; background: var(--secondary); color: #fff; border: none; padding: 0.4em 0.7em; border-radius: 10px; font-size: 0.9em; cursor:pointer;}
    .cover-select { position:absolute; right:14px; top:14px;}
    .cover-swatches { display:flex; gap:7px;}
    .swatch { width:28px; height:28px; border-radius:7px; border:2px solid #fff; cursor:pointer; box-shadow: 0 2px 10px #0002;}
    .swatch.selected { border:3px solid var(--dark-yellow);}
    .card-area, .info-area, .invest-area { margin:1.5em 1em;}
    .c-name { color: var(--dark-yellow); font-size: 1.5em; font-weight:700; text-align:center;}
    .c-info { color: #cbe7fa; text-align:center; margin:.2em 0 .5em;}
    .c-id { color: var(--secondary); text-align:center; font-size:1.1em;}
    .member-cards { display:flex; gap:1em; justify-content:center; margin: 1.5em 0 0.5em 0;}
    .m-card { min-width:120px; background:#292929; border-radius:13px; padding:1.1em 1em; color:#fff; text-align:center; box-shadow:0 2px 14px #0003; cursor:pointer; transition: transform .25s;}
    .m-card.gold { background: linear-gradient(120deg,#ffd700,#ffeb66);}
    .m-card.silver { background: linear-gradient(120deg,#d0d0d0,#fff);}
    .m-card.bronze { background: linear-gradient(120deg,#b08d57,#ffe7b2);}
    .m-card.animated { transform: scale(1.09) rotate(-2deg);}
    .member-pay { margin-top:0.7em; text-align:center;}
    .member-pay button { background:var(--secondary); color:#fff; border:none; padding:0.5em 1.4em; border-radius:7px; font-weight:600; cursor:pointer; margin:0 0.5em;}
    .member-status { text-align:center; color: var(--gold); font-weight:700; }
    .info-label { color:var(--dark-yellow); font-weight:700; }
    .menu { display:flex; justify-content:space-around; align-items:center; background:#112945; border-radius:19px 19px 0 0; position:sticky; bottom:0; left:0; right:0; z-index:10; margin-top:0.6em; padding:0.3em 0.12em; box-shadow:0 -2px 12px #0003;}
    .menu a { flex:1; text-align:center; color:var(--white); font-size:0.97em; padding:0.5em 0;}
    .menu span { display:block;}
    .menu a span:first-child {font-size:1.19em; margin-bottom:0.1em;}
    .form-modal { display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0006; z-index:9999; align-items:center; justify-content:center;}
    .form-modal.active { display:flex;}
    .modal-box { background:#18345a; padding:2em 1.2em; border-radius:14px; max-width:340px; width:93vw; box-shadow:0 2px 18px #0005;}
    .modal-box h3 { color:var(--dark-yellow);}
    .modal-box label { color:var(--secondary); font-weight:600;}
    .modal-box input, .modal-box textarea { width:100%; margin-top:0.2em; border:none; border-radius:7px; padding:0.65em;}
    .modal-box button { background:var(--secondary); color:#fff; border:none; border-radius:7px; margin-top:1em; padding:0.55em 1.2em; font-weight:600;}
    .close-btn { position:absolute; right:7vw; top:7vh; background:var(--dark-yellow); border:none; border-radius:50%; width:32px; height:32px; font-size:1.2em; cursor:pointer;}
    .invest-area { margin-bottom:5em;}
    .invest-slider { display:flex; overflow-x:auto; gap:1em; padding:1em 0;}
    .invest-slide { min-width:215px; background:#23406c; border-radius:13px; padding:1em 1em; box-shadow:0 2px 16px #0003; color:#ffd600;}
    .invest-title { font-weight:700; color:#ffd600;}
    .invest-desc { color:#cbe7fa; font-size:0.98em;}
    footer { background: #0e233a; text-align: center; padding: 1.2em 0 0.7em 0; font-size: 0.93em; color: #e3e3e3; border-radius: 14px 14px 0 0; margin-top: 3em;}
    footer a { color: var(--dark-yellow);}
  </style>
</head>
<body>
  <div id="cover" class="cover"></div>
  <div class="profile-box">
    <img src="../images/default-profile.png" id="profilePic" class="profile-pic" alt="Profile Photo">
    <input type="file" id="profileUpload" accept="image/*" style="display:none">
    <button class="upload-btn" onclick="document.getElementById('profileUpload').click()">Upload Photo</button>
    <div class="cover-select">
      <div class="cover-swatches" id="coverSwatches"></div>
    </div>
  </div>
  <div class="info-area">
    <div class="c-name" id="cName"></div>
    <div class="c-info"><span id="cPhone"></span> | <span id="cEmail"></span></div>
    <div class="c-info"><span>Joined: <span id="cJoin"></span></span></div>
    <div class="c-id" id="cID"></div>
  </div>
  <div class="card-area">
    <div class="member-cards">
      <div class="m-card gold" id="goldCard" onclick="animateCard('gold')">
        <div style="font-size:1.6em;">ü•á</div>
        <div style="font-weight:700;">Gold</div>
        <div style="font-size:1.2em;">‚Çπ1000</div>
        <div style="font-size:0.98em; margin-top:0.35em;color:#444;">VIP benefits, free annual service, highest referral bonus</div>
      </div>
      <div class="m-card silver" id="silverCard" onclick="animateCard('silver')">
        <div style="font-size:1.6em;">ü•à</div>
        <div style="font-weight:700;">Silver</div>
        <div style="font-size:1.2em;">‚Çπ500</div>
        <div style="font-size:0.98em; margin-top:0.35em;color:#444;">Standard member, discounted service, referral rewards</div>
      </div>
      <div class="m-card bronze" id="bronzeCard" onclick="animateCard('bronze')">
        <div style="font-size:1.6em;">ü•â</div>
        <div style="font-weight:700;">Bronze</div>
        <div style="font-size:1.2em;">‚Çπ250</div>
        <div style="font-size:0.98em; margin-top:0.35em;color:#444;">Basic access, member-only offers, loyalty points</div>
      </div>
    </div>
    <div class="member-pay" id="memberPayArea">
      <span style="color:#cbe7fa;">Choose your membership card and click to pay securely:</span><br>
      <button onclick="payMember('gold')">Pay Gold ‚Çπ1000</button>
      <button onclick="payMember('silver')">Pay Silver ‚Çπ500</button>
      <button onclick="payMember('bronze')">Pay Bronze ‚Çπ250</button>
    </div>
    <div class="member-status" id="memberStatus"></div>
  </div>
  <div class="menu shadow">
    <a href="#" onclick="openForm('appointment')"><span>üìÖ</span><span>Appointment</span></a>
    <a href="#" onclick="openForm('price')"><span>üíµ</span><span>Price Check</span></a>
    <a href="#" onclick="openForm('estimate')"><span>üßÆ</span><span>Estimate</span></a>
    <a href="#" onclick="openForm('order')"><span>üöö</span><span>Order Tracker</span></a>
    <a href="#" onclick="openForm('payment')"><span>üí≥</span><span>Payment</span></a>
    <a href="#" onclick="openForm('complaint')"><span>üì¢</span><span>Complaint</span></a>
    <a href="#" onclick="openForm('rework')"><span>üîÅ</span><span>Rework Status</span></a>
  </div>
  <!-- Modal for forms -->
  <div id="formModal" class="form-modal"><div class="modal-box" id="modalBox"></div><button class="close-btn" onclick="closeModal()">‚úñÔ∏è</button></div>
  <div class="invest-area">
    <h2 style="color:#ffd600;text-align:center;">Investment Opportunities</h2>
    <div class="invest-slider" id="investSlider">
      <div class="invest-slide">
        <div class="invest-title">Franchise Partner</div>
        <div class="invest-desc">Become a Raj Marketing franchise in your city. Low investment, high returns, and full business support!</div>
      </div>
      <div class="invest-slide">
        <div class="invest-title">Referral Investor</div>
        <div class="invest-desc">Refer customers and earn commission on every sale. No fixed cost, unlimited earnings!</div>
      </div>
      <div class="invest-slide">
        <div class="invest-title">Bulk Buyer Program</div>
        <div class="invest-desc">Invest in bulk orders at discounted rates, and resell in your network for higher profits.</div>
      </div>
      <div class="invest-slide">
        <div class="invest-title">Service Partner</div>
        <div class="invest-desc">Join as a certified installer or service partner. Training, leads & growth with Raj Marketing Mysore.</div>
      </div>
    </div>
  </div>
  <footer>
    <div>
      &copy; 2025 Raj Marketing Mysore. All Rights Reserved.<br>
      <span>üìç Mysore, India | üì± <a href="tel:+919483037385">+91-9483037385</a></span>
    </div>
  </footer>
<script>
// Gradient backgrounds
const gradients = [
  "linear-gradient(120deg,#0e2a47,#3bb4f2)",
  "linear-gradient(120deg,#ffd600,#ffd700)",
  "linear-gradient(120deg,#b08d57,#ffd700)",
  "linear-gradient(120deg,#3bb4f2,#fff)",
  "linear-gradient(120deg,#0e2a47,#ffd600)",
  "linear-gradient(120deg,#d0d0d0,#18345a)",
  "linear-gradient(120deg,#18345a,#3bb4f2)"
];

const swatchColors = ["#0e2a47", "#ffd600", "#b08d57", "#3bb4f2", "#18345a", "#d0d0d0", "#2a78d1"];
const swatchEl = document.getElementById('coverSwatches');
gradients.forEach((g, i)=>{
  const s = document.createElement('div');
  s.className = 'swatch';
  s.style.background = gradients[i];
  s.onclick = ()=>setCover(i);
  swatchEl.appendChild(s);
});

function setCover(i){
  user.cover = i;
  document.getElementById('cover').style.background = gradients[i];
  updateSwatch();
  saveUser();
}
function updateSwatch() {
  swatchEl.querySelectorAll('.swatch').forEach((sw,idx)=>{
    sw.classList.toggle('selected', idx===user.cover);
  });
}

// Load user
let users = JSON.parse(localStorage.getItem('raj_users')||'[]');
let phone = localStorage.getItem('raj_loggedin');
let user = users.find(u=>u.phone===phone);
if(!user){ window.location.href="login.html"; }
// Generate customer ID if not present
if(!user.id) {
  let n = user.name.replace(/[^a-zA-Z]/g,'').slice(0,4).toUpperCase();
  let p = user.phone.slice(-4);
  user.id = n + p;
  saveUser();
}
function saveUser(){
  users = users.map(u=>u.phone===user.phone?user:u);
  localStorage.setItem('raj_users', JSON.stringify(users));
}

// Profile photo
const profilePic = document.getElementById('profilePic');
if(user.profile) profilePic.src = user.profile;
document.getElementById('profileUpload').onchange = function(e){
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(ev){
      user.profile = ev.target.result;
      profilePic.src = user.profile;
      saveUser();
    };
    reader.readAsDataURL(file);
  }
};

// Cover
document.getElementById('cover').style.background = gradients[user.cover||0];
updateSwatch();

// Info
document.getElementById('cName').textContent = user.name;
document.getElementById('cPhone').textContent = user.phone;
document.getElementById('cEmail').textContent = user.email;
document.getElementById('cJoin').textContent = user.joinDate;
document.getElementById('cID').textContent = "Customer ID: "+user.id;

// Membership
function animateCard(type){
  ["gold","silver","bronze"].forEach(t=>{
    document.getElementById(t+"Card").classList.remove('animated');
  });
  document.getElementById(type+"Card").classList.add('animated');
  setTimeout(()=>{
    document.getElementById(type+"Card").classList.remove('animated');
  },700);
}
function payMember(type){
  user.member = type;
  user.memberPay = true;
  saveUser();
  updateMember();
}
function updateMember(){
  const area = document.getElementById('memberPayArea');
  const status = document.getElementById('memberStatus');
  if(user.memberPay && user.member){
    area.style.display="none";
    status.innerHTML = `Membership Active: <span style="text-transform:capitalize;">${user.member}</span> Card`;
  }else{
    area.style.display="block";
    status.textContent='';
  }
}
updateMember();

// Menu & Forms
const formDefs = {
  appointment: { title:"Book Appointment", fields:[
    {label:"Preferred Date",type:"date",name:"date",required:true},
    {label:"Preferred Time",type:"time",name:"time",required:true},
    {label:"Address",type:"textarea",name:"address",required:true},
  ]},
  price: { title:"Price Check", fields:[
    {label:"Product Type",type:"text",name:"product",required:true},
    {label:"Size (ft/inch)",type:"text",name:"size",required:true},
    {label:"Additional Notes",type:"textarea",name:"notes"}
  ]},
  estimate: { title:"Get Estimate", fields:[
    {label:"Product",type:"text",name:"product",required:true},
    {label:"Total Windows/Doors",type:"number",name:"qty",required:true},
    {label:"Site Address",type:"textarea",name:"address",required:true}
  ]},
  order: { title:"Order Tracker", fields:[
    {label:"Order ID (if known)",type:"text",name:"orderid"},
    {label:"Query",type:"textarea",name:"query",required:true}
  ]},
  payment: { title:"Payment", fields:[
    {label:"Amount",type:"number",name:"amount",required:true},
    {label:"Payment Method",type:"text",name:"method",required:true},
    {label:"Notes",type:"textarea",name:"notes"}
  ]},
  complaint: { title:"Complaint", fields:[
    {label:"Your Complaint",type:"textarea",name:"complaint",required:true}
  ]},
  rework: { title:"Rework Status", fields:[
    {label:"Order/Service ID",type:"text",name:"orderid"},
    {label:"Details",type:"textarea",name:"details",required:true}
  ]}
};
function openForm(type){
  const d = formDefs[type];
  let html = `<h3>${d.title}</h3><form id="modalForm">`;
  d.fields.forEach(f=>{
    html+=`<label>${f.label}${f.required?' *':''}</label>`;
    if(f.type==="textarea")
      html+=`<textarea name="${f.name}" ${f.required?'required':''}></textarea>`;
    else
      html+=`<input name="${f.name}" type="${f.type}" ${f.required?'required':''}>`;
  });
  html+=`<button type="submit">Submit</button></form>`;
  document.getElementById('modalBox').innerHTML = html;
  document.getElementById('formModal').classList.add('active');
  document.getElementById('modalForm').onsubmit = function(e){
    e.preventDefault();
    // Store per user, per form type
    const formData = {};
    d.fields.forEach(f=>formData[f.name]=this[f.name].value);
    if(!user.forms)user.forms={};
    user.forms[type] = formData;
    saveUser();
    closeModal();
    alert(d.title+" submitted successfully!");
  }
}
function closeModal(){
  document.getElementById('formModal').classList.remove('active');
}
</script>
</body>
</html>
